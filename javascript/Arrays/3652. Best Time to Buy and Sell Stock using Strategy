var maxProfit = function(prices, strategy, k) {
      const profitsFromFront=[];
      const profitsFromBehind=[];
      const totals=[];
      let answer=0;
      let profitFromFront=0;
      let profitFromBehind=0;
      let totalFromFront=0;
      let totalFromBehind=0;
      const totalsFromFront=[];
      const totalsFromBehind=[];
      for(let i=0;i<prices.length;i++){
        profitsFromFront.push(0);
        profitsFromBehind.push(0);
        totalsFromFront.push(0);
        totalsFromBehind.push(0);
      }
      for(let i=0;i<prices.length;i++){
        profitFromFront+=prices[i]*strategy[i];
        profitsFromFront[i]=profitFromFront;
        totalFromFront+=prices[i];
        totalsFromFront[i]=totalFromFront;
      }  
      for(let i=prices.length-1;i>=0;i--){
        profitFromBehind+=prices[i]*strategy[i];
        profitsFromBehind[i]=profitFromBehind;
        totalFromBehind+=prices[i];
        totalsFromBehind[i]=totalFromBehind;
      }
       answer=profitFromFront;  
       let currentTotal=0;
       if(k!=prices.length)
        currentTotal=totalsFromFront[k-1]-totalsFromFront[(k/2)-1]+profitsFromBehind[k];
       else 
        currentTotal=totalsFromFront[k-1]-totalsFromFront[(k/2)-1];
       answer=Math.max(answer,currentTotal);  
       for(let i=0;i<prices.length-k;i++){
        currentTotal=profitsFromFront[i]+totalsFromFront[i+k]-totalsFromFront[i+(k/2)];
        if(i<prices.length-k-1)currentTotal+=profitsFromBehind[i+k+1];
        answer=Math.max(answer,currentTotal);
       }
       return answer;  
};
